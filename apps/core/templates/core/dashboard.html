{% extends 'core/base.html' %} {% block title %}Dashboard{% endblock %}
<!-- This is a comment -->
{% block content %}
<div class="container dashboard-page">
  <h2>Dashboard</h2>

  <!-- Messages KPIs -->
  <div class="dashboard-grid">
    <div
      class="dashboard-card clickable"
      onclick="location.href='{% url 'core:inbox' %}'"
    >
      <h3>Total Messages</h3>
      <p>{{ total_messages }}</p>
    </div>
    <div class="dashboard-card card-unread clickable">
      <h3>Unread</h3>
      <p>{{ unread_messages }}</p>
    </div>
    <div class="dashboard-card card-archived clickable">
      <h3>Archived</h3>
      <p>{{ archived_messages }}</p>
    </div>
    <div class="dashboard-card card-today clickable">
      <h3>Today</h3>
      <p>{{ today_messages }}</p>
    </div>
  </div>

  <!-- Quiz KPIs -->
  <h3 style="margin-top: 2rem">Quiz Analytics</h3>
  <div class="dashboard-grid">
    <div class="dashboard-card">
      <h3>Total Quizzes</h3>
      <p>{{ total_quizzes }}</p>
    </div>
    <div class="dashboard-card">
      <h3>Total Attempts</h3>
      <p>{{ total_attempts }}</p>
    </div>
    <div class="dashboard-card">
      <h3>Average Score</h3>
      <p>{{ avg_score|floatformat:2 }}</p>
    </div>
    <div class="dashboard-card card-warning">
      <h3>Quizzes with Negative Marks</h3>
      <p>{{ negative_quizzes }}</p>
    </div>
  </div>

  <!-- Top / Hardest Quizzes -->
  <div class="recent-quizzes card">
    <h3>Top Attempted Quizzes</h3>
    <ul>
      {% for quiz in top_quizzes %}
      <li>{{ quiz.quiz__title }} - {{ quiz.num_attempts }} attempts</li>
      {% endfor %}
    </ul>
  </div>

  <div class="recent-quizzes card">
    <h3>Hardest Quizzes (Lowest Avg Score)</h3>
    <ul>
      {% for quiz in hardest_quizzes %}
      <li>{{ quiz.quiz__title }} - Avg: {{ quiz.avg_score|floatformat:2 }}</li>
      {% endfor %}
    </ul>
  </div>

  <!-- Recently Created Quizzes -->
  <div class="recent-quizzes card">
    <h3>Recently Created Quizzes</h3>
    <ul>
      {% for quiz in recent_quizzes %}
      <li>{{ quiz.title }} ({{ quiz.created_at|date:"d M Y" }})</li>
      {% endfor %}
    </ul>
  </div>
</div>
{% endblock %}
